version: 1
applications:
  - frontend:
      frontendRoot: soymusico  # Ubicaci贸n de la carpeta que contiene React
      phases:
        preBuild:
          commands:
            - cd soymusico
            - npm install
        build:
          commands:
            - cd soymusico
            - npm run build # Genera el build de producci贸n de React
      artifacts:
        baseDirectory: soymusico/build # Ubicaci贸n del build de React
        files:
          - '**/*'
      cache:
        paths:
          - soymusico/node_modules/**/*
      customHeaders:
        - pattern: '**'
          headers:
            - key: 'Cache-Control'
              value: 'no-cache, no-store, must-revalidate'
  backend:
    backendRoot: soymusicomessaging  # Ubicaci贸n de la carpeta que contiene Django
    phases:
      preBuild:
        commands:
          - cd soymusicomessaging
          - pip install -r requirements.txt
      build:
        commands:
          - cd soymusicomessaging
          - python manage.py migrate
          - python manage.py collectstatic --noinput
    startCommand: cd soymusicomessaging && python manage.py runserver